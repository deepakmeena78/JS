<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Crop and Download</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.6.2/cropper.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.6.2/cropper.min.css">
</head>

<body>
    <script>
        // Create main elements
        const body = document.body;
        body.style.cssText = "margin: 0; font-family: Poppins, sans-serif; background-color: #025bee;";

        // Wrapper
        const wrapper = document.createElement("div");
        wrapper.style.cssText = "width: min(90%, 800px); position: absolute; transform: translateX(-50%); top: 1em; left: 50%; background-color: #ffffff; padding: 2em 3em; border-radius: 0.5em;";

        // Container
        const container = document.createElement("div");
        container.style.cssText = "display: grid; grid-template-columns: 1fr 1fr; gap: 1em; border-radius: 7px;";

        // Image Container
        const imageContainer = document.createElement("div");
        imageContainer.style.cssText = "width: 60%; margin: 0 auto;";

        const image = document.createElement("img");
        image.id = "image";
        image.style.cssText = "display: block; max-width: 100%;";
        imageContainer.appendChild(image);

        // Preview Container
        const previewContainer = document.createElement("div");
        previewContainer.style.cssText = "width: 100%;";

        const previewImage = document.createElement("img");
        previewImage.id = "preview-image";
        previewImage.style.cssText = "display: block; max-width: 100%;";
        previewContainer.appendChild(previewImage);

        container.appendChild(imageContainer);
        container.appendChild(previewContainer);

        // File input and label
        const fileInput = document.createElement("input");
        fileInput.type = "file";
        fileInput.id = "file";
        fileInput.accept = "image/*";
        fileInput.style.cssText = "display: none;";

        const fileLabel = document.createElement("label");
        fileLabel.htmlFor = "file";
        fileLabel.textContent = "Choose A Photo";
        fileLabel.style.cssText = "display: block; position: relative; background-color: #025bee; color: #ffffff; font-size: 16px; text-align: center; width: 250px; padding: 16px 0; border-radius: 0.3em; margin: 16px auto; cursor: pointer;";

        // Options
        const options = document.createElement("div");
        options.classList.add("options", "hide");
        options.style.cssText = "display: flex; flex-wrap: wrap; justify-content: center; gap: 1em; margin-top: 1em;";

        // Aspect ratio buttons
        const button16_9 = document.createElement("button");
        button16_9.textContent = "16:9";
        button16_9.style.cssText = "padding: 1em; border-radius: 0.3em; border: 2px solid #025bee; background-color: #ffffff; color: #025bee; cursor: pointer; font-size: 1em;";
        button16_9.addEventListener("click", () => cropper.setAspectRatio(16 / 9));
        options.appendChild(button16_9);

        const button4_3 = document.createElement("button");
        button4_3.textContent = "4:3";
        button4_3.style.cssText = "padding: 1em; border-radius: 0.3em; border: 2px solid #025bee; background-color: #ffffff; color: #025bee; cursor: pointer; font-size: 1em;";
        button4_3.addEventListener("click", () => cropper.setAspectRatio(4 / 3));
        options.appendChild(button4_3);

        const button1_1 = document.createElement("button");
        button1_1.textContent = "1:1";
        button1_1.style.cssText = "padding: 1em; border-radius: 0.3em; border: 2px solid #025bee; background-color: #ffffff; color: #025bee; cursor: pointer; font-size: 1em;";
        button1_1.addEventListener("click", () => cropper.setAspectRatio(1));
        options.appendChild(button1_1);

        const button2_3 = document.createElement("button");
        button2_3.textContent = "2:3";
        button2_3.style.cssText = "padding: 1em; border-radius: 0.3em; border: 2px solid #025bee; background-color: #ffffff; color: #025bee; cursor: pointer; font-size: 1em;";
        button2_3.addEventListener("click", () => cropper.setAspectRatio(2 / 3));
        options.appendChild(button2_3);

        const buttonFree = document.createElement("button");
        buttonFree.textContent = "Free";
        buttonFree.style.cssText = "padding: 1em; border-radius: 0.3em; border: 2px solid #025bee; background-color: #ffffff; color: #025bee; cursor: pointer; font-size: 1em;";
        buttonFree.addEventListener("click", () => cropper.setAspectRatio(NaN));
        options.appendChild(buttonFree);

        // Width and height input fields
        const widthInput = document.createElement("input");
        widthInput.type = "number";
        widthInput.id = "width-input";
        widthInput.placeholder = "Enter Width";
        widthInput.max = 780;
        widthInput.style.cssText = "width: 100px; padding: 0.5em; border-radius: 0.3em; border: 2px solid #000000;";
        options.appendChild(widthInput);

        const heightInput = document.createElement("input");
        heightInput.type = "number";
        heightInput.id = "height-input";
        heightInput.placeholder = "Enter Height";
        heightInput.max = 780;
        heightInput.style.cssText = "width: 100px; padding: 0.5em; border-radius: 0.3em; border: 2px solid #000000;";
        options.appendChild(heightInput);

        // Buttons for preview and download
        const btns = document.createElement("div");
        btns.style.cssText = "display: flex; justify-content: center; gap: 1em; margin-top: 1em;";

        const previewButton = document.createElement("button");
        previewButton.id = "preview";
        previewButton.textContent = "Preview";
        previewButton.classList.add("hide");
        previewButton.style.cssText = "padding: 1em; border-radius: 0.3em; border: 2px solid #025bee; background-color: #ffffff; color: #025bee; font-size: 1em;";
        btns.appendChild(previewButton);

        const downloadButton = document.createElement("a");
        downloadButton.id = "download";
        downloadButton.textContent = "Download";
        downloadButton.href = "#";
        downloadButton.classList.add("hide");
        downloadButton.style.cssText = "text-decoration: none; border: 2px solid #025bee; background-color: #025bee; color: #ffffff; padding: 1em; font-size: 1em; border-radius: 0.3em;";
        btns.appendChild(downloadButton);

        // Append everything to the wrapper and then to the body
        wrapper.appendChild(container);
        wrapper.appendChild(fileInput);
        wrapper.appendChild(fileLabel);
        wrapper.appendChild(options);
        wrapper.appendChild(btns);
        body.appendChild(wrapper);

        // JavaScript Logic for Image Cropping
        let cropper;
        let fileName = "";

        fileInput.addEventListener("change", () => {
            const reader = new FileReader();
            reader.onload = () => {
                image.src = reader.result;
                if (cropper) cropper.destroy();
                cropper = new Cropper(image);
                options.classList.remove("hide");
                previewButton.classList.remove("hide");
            };
            fileName = fileInput.files[0].name.split(".")[0];
            reader.readAsDataURL(fileInput.files[0]);
        });

        // Width and height input functionality
        widthInput.addEventListener("input", () => {
            const width = parseInt(widthInput.value);
            if (width) cropper.setCropBoxData({ width });
        });

        heightInput.addEventListener("input", () => {
            const height = parseInt(heightInput.value);
            if (height) cropper.setCropBoxData({ height });
        });

        // Preview and download functionality
        previewButton.addEventListener("click", () => {
            const croppedData = cropper.getCroppedCanvas().toDataURL();
            previewImage.src = croppedData;
            downloadButton.href = croppedData;
            downloadButton.download = `${fileName}_cropped.png`;
            downloadButton.classList.remove("hide");
        });
    </script>
</body>

</html>